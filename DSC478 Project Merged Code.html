<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html><head></head><body>





















    
    
    
    

  <div class="border-box-sizing">
    <div class="container">

<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1>DSC 478 Team Project<a rel="noopener" class="anchor-link" href="#DSC-478-Team-Project">&#182;</a></h1><h2>Adam Hecktman, Devindra “Dave” Sawh<a rel="noopener" class="anchor-link" href="#Adam-Hecktman,-Devindra-“Dave”-Sawh">&#182;</a></h2><h2>Consumer Services Complaints for The City of New York<a rel="noopener" class="anchor-link" href="#Consumer-Services-Complaints-for-The-City-of-New-York">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[426]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[427]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;Cleansed Consumer_Services_Mediated_Complaints.csv&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[427]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(2792, 17)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[428]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#drop columns not needed</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Complaint Result&#39;</span><span class="p">,</span><span class="s1">&#39;Business Building&#39;</span> <span class="p">,</span><span class="s1">&#39;Business Street&#39;</span><span class="p">,</span> <span class="s1">&#39;Building Address Unit&#39;</span><span class="p">,</span> <span class="s1">&#39;Business City&#39;</span><span class="p">,</span> <span class="s1">&#39;Business Zip&#39;</span><span class="p">,</span> <span class="s1">&#39;Complainant Zip&#39;</span><span class="p">,</span> <span class="s1">&#39;Longitude&#39;</span><span class="p">,</span> <span class="s1">&#39;Latitude&#39;</span><span class="p">])</span>
<span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 2792 entries, 0 to 2791
Data columns (total 8 columns):
Business Name           2757 non-null object
Industry                2792 non-null object
Complaint Type          2616 non-null object
Mediation Start Date    2791 non-null object
Mediation Close Date    2792 non-null object
Satisfaction            2225 non-null object
Restitution             2792 non-null object
Business State          2739 non-null object
dtypes: object(8)
memory usage: 174.6+ KB
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[429]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">Industry</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[429]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([&#39;Secondhand Dealer Auto - 005&#39;, &#39;Tow Truck Company - 124&#39;,
       &#39;Laundry - 064&#39;, &#39;Travel Agency - 440&#39;,
       &#39;Dealer In Products For The Disabled - 119&#39;,
       &#39;Home Improvement Contractor - 100&#39;, &#39;Furniture Sales - 242&#39;,
       &#39;Misc Non-Food Retail - 817&#39;, &#39;Debt Collection Agency - 122&#39;,
       &#39;Locksmith - 062&#39;, &#39;Retail Store - 820&#39;, &#39;Health Spa - 839&#39;,
       &#39;Electronic &amp; Home Appliance Service Dealer - 115&#39;, &#39;Garage - 049&#39;,
       &#39;Restaurant - 818&#39;, &#39;Other&#39;, &#39;Electronic Store - 001&#39;,
       &#39;Auto Rental - 213&#39;, &#39;Tax Preparers - 891&#39;,
       &#39;Sightseeing Bus - 078&#39;, &#39;Gas Station-Retail - 815&#39;,
       &#39;Jewelry Store-Retail - 823&#39;, &#39;Dry Cleaners - 230&#39;,
       &#39;Appliances - 244&#39;, &#39;Employment Agency - 034&#39;, &#39;Supermarket - 819&#39;,
       &#39;Grocery-Retail - 808&#39;, &#39;Mini-Storage Company - 830&#39;,
       &#39;Megastore - 821&#39;, &#39;Funeral Homes - 888&#39;, &#39;Hotel/Motel - 460&#39;,
       &#39;Parking Lot - 050&#39;, &#39;Ticket Seller Business&#39;,
       &#39;Hardware-Retail - 811&#39;, &#39;Mailorder Misc - 319&#39;,
       &#39;Drug Store Retail - 810&#39;, &#39;Car Wash&#39;, &#39;Wearing Apparel - 450&#39;,
       &#39;Auction House - 128&#39;, &#39;Sightseeing Guide - 021&#39;,
       &#39;Pawnbroker - 080&#39;, &#39;Catering Establishment - 075&#39;,
       &#39;Auto Dealership - 212&#39;, &#39;Debt Settlement - 248&#39;,
       &#39;Pedicab Driver - 131&#39;, &#39;Garage &amp; Parking Lot - 098&#39;,
       &#39;Storage Warehouse - 120&#39;, &#39;Secondhand Dealer [General] - 006&#39;,
       &#39;Internet Complaints - 443&#39;, &#39;Tenant Screening - 480&#39;,
       &#39;Stoop Line Stand - 033&#39;, &#39;Immigration Svc Prv - 893&#39;,
       &#39;Salons And Barbershop - 841&#39;, &#39;Fuel Oil Dealer - 814&#39;,
       &#39;Tow Truck Driver - 125&#39;, &#39;Booting Company - 126&#39;,
       &#39;Tickets-Live Perf - 260&#39;, &#39;Auctioneer - 036&#39;,
       &#39;Floor Coverings - 241&#39;, &#39;Pool Or Billiard Room - 046&#39;,
       &#39;Photography Services - 415&#39;, &#39;Auto Leasing - 211&#39;], dtype=object)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[430]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Complaint Type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[430]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([&#39;Damaged Goods - D01&#39;, &#39;Lemon&#39;, &#39;Billing Dispute - B02&#39;,
       &#39;Refund Policy - R01&#39;, &#39;Surcharge/Overcharge - S02&#39;,
       &#39;Non-Delivery of Goods - N01&#39;, nan, &#39;Quality of Work - Q01&#39;,
       &#39;Non-Delivery of Service - N02&#39;, &#39;Misrepresentation - M01&#39;,
       &#39;Breach of Contract - B03&#39;, &#39;Illegal/Unfair Booting&#39;,
       &#39;Exchange Goods/Contract Cancelled - E01&#39;,
       &#39;Advertising/General - A01&#39;, &#39;Defective Goods - D02&#39;,
       &#39;Unauthorized tow&#39;, &#39;Lost Property - L02&#39;,
       &#39;Advertising/Misleading - A02&#39;, &#39;Credit Card Discrepancy - C01&#39;,
       &#39;Damage / Estimate&#39;, &#39;Service Install - S01&#39;,
       &#39;Outstanding Judgment - J01&#39;, &#39;Breach of Warranty - B04&#39;,
       &#39;Credit Card Limitations Not Posted&#39;,
       &#39;Cancellation/Closure Without Notice&#39;,
       &#39;Receipt Incomplete/Not Given&#39;, &#39;Over Capacity&#39;,
       &#39;Unauthorized Repair - U01&#39;, &#39;Health Spa - 839&#39;,
       &#39;Unsanitary conditions&#39;, &#39;Advertising/Non-Availability - A03&#39;,
       &#39;Wrong Goods - W01&#39;, &#39;Other - Z01&#39;, &#39;Closed without Notice&#39;,
       &#39;No Title Provided&#39;, &#39;Minor Present School Hours&#39;, &#39;Restock Fee&#39;,
       &#39;Unlicensed&#39;, &#39;Unauthorized charges&#39;, &#39;Bait &amp; Switch - B01&#39;,
       &#39;Harassment - H01&#39;, &#39;Gender Pricing&#39;,
       &#39;Dissatisfaction with Provider&#39;, &#39;Expiration date&#39;,
       &#39;Cancellation Fee&#39;, &#39;Refurbished /used&#39;,
       &#39;Non-Delivery Goods/Services&#39;, &#39;Scale Inaccurate/Broken&#39;,
       &#39;Price Not Posted&#39;, &#39;Bugs&#39;, &#39;Contact Sign Not Posted&#39;,
       &#39;Satisfaction With Provider&#39;], dtype=object)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[431]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Satisfaction&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[431]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([&#39;No&#39;, &#39;Yes&#39;, nan], dtype=object)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[432]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Business State&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[432]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([&#39;NY&#39;, &#39;NC&#39;, &#39;GA&#39;, &#39;KS&#39;, &#39;CA&#39;, nan, &#39;UT&#39;, &#39;WI&#39;, &#39;NJ&#39;, &#39;MN&#39;, &#39;MS&#39;,
       &#39;IL&#39;, &#39;WA&#39;, &#39;MI&#39;, &#39;TX&#39;, &#39;AZ&#39;, &#39;RI&#39;, &#39;FL&#39;, &#39;CT&#39;, &#39;KY&#39;, &#39;NH&#39;, &#39;OH&#39;,
       &#39;NEW YORK&#39;, &#39;SC&#39;, &#39;NM&#39;, &#39;TN&#39;, &#39;PA&#39;, &#39;VA&#39;, &#39;MA&#39;, &#39;MD&#39;, &#39;CO&#39;, &#39;MO&#39;,
       &#39;LA&#39;, &#39;IA&#39;, &#39;NV&#39;, &#39;DE&#39;], dtype=object)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[&#160;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[433]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#charges = pd.read_csv(&quot;Charges.csv&quot;, index_col=0)</span>
<span class="c1">#charges.info()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[434]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#BusNameCharged = charges[&#39;Business Name&#39;].unique()</span>
<span class="c1">#len(BusNameCharged)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[435]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[435]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Business Name</th>
      <th>Industry</th>
      <th>Complaint Type</th>
      <th>Mediation Start Date</th>
      <th>Mediation Close Date</th>
      <th>Satisfaction</th>
      <th>Restitution</th>
      <th>Business State</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>MAJOR WORLD CHEVROLET, L.L.C.</td>
      <td>Secondhand Dealer Auto - 005</td>
      <td>Damaged Goods - D01</td>
      <td>4/26/2019</td>
      <td>5/9/2019</td>
      <td>No</td>
      <td>0</td>
      <td>NY</td>
    </tr>
    <tr>
      <td>1</td>
      <td>CYPRESS MOTORS OF RIDGEWOOD INC,</td>
      <td>Secondhand Dealer Auto - 005</td>
      <td>Lemon</td>
      <td>4/11/2019</td>
      <td>5/22/2019</td>
      <td>Yes</td>
      <td>2400</td>
      <td>NY</td>
    </tr>
    <tr>
      <td>2</td>
      <td>FINEST AUTOMOTIVE RECOVERY INC</td>
      <td>Tow Truck Company - 124</td>
      <td>Billing Dispute - B02</td>
      <td>4/10/2019</td>
      <td>5/7/2019</td>
      <td>Yes</td>
      <td>60</td>
      <td>NY</td>
    </tr>
    <tr>
      <td>3</td>
      <td>U NICE LAUNDRY INC</td>
      <td>Laundry - 064</td>
      <td>Refund Policy - R01</td>
      <td>11/25/2019</td>
      <td>12/10/2019</td>
      <td>Yes</td>
      <td>4</td>
      <td>NY</td>
    </tr>
    <tr>
      <td>4</td>
      <td>LEVIA TOUR LLC</td>
      <td>Travel Agency - 440</td>
      <td>Surcharge/Overcharge - S02</td>
      <td>2/1/2019</td>
      <td>3/11/2019</td>
      <td>NaN</td>
      <td>0</td>
      <td>NY</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[436]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#NewCol = [1 if x in BusNameCharged else 0 for x in df[&#39;Business Name&#39;]] </span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[437]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#print(NewCol)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[438]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#new_charges = charges[[&#39;Business Name&#39;]]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[439]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#new_charges.head()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[440]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">shape</span>  
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[440]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(2792, 8)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1>Data Transformation<a rel="noopener" class="anchor-link" href="#Data-Transformation">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[441]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Satisfaction&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()]</span>  <span class="c1">#target column with null records.  We need to delete these records.</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[441]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Business Name</th>
      <th>Industry</th>
      <th>Complaint Type</th>
      <th>Mediation Start Date</th>
      <th>Mediation Close Date</th>
      <th>Satisfaction</th>
      <th>Restitution</th>
      <th>Business State</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>4</td>
      <td>LEVIA TOUR LLC</td>
      <td>Travel Agency - 440</td>
      <td>Surcharge/Overcharge - S02</td>
      <td>2/1/2019</td>
      <td>3/11/2019</td>
      <td>NaN</td>
      <td>0</td>
      <td>NY</td>
    </tr>
    <tr>
      <td>5</td>
      <td>MEDICAL EQUIPMENT REPAIRS &amp; DISTRIBUTION INC.</td>
      <td>Dealer In Products For The Disabled - 119</td>
      <td>Non-Delivery of Goods - N01</td>
      <td>1/29/2019</td>
      <td>2/14/2019</td>
      <td>NaN</td>
      <td>0</td>
      <td>NY</td>
    </tr>
    <tr>
      <td>7</td>
      <td>JML AUTO GROUP LLC</td>
      <td>Secondhand Dealer Auto - 005</td>
      <td>NaN</td>
      <td>6/18/2019</td>
      <td>7/16/2019</td>
      <td>NaN</td>
      <td>0</td>
      <td>NY</td>
    </tr>
    <tr>
      <td>12</td>
      <td>LIC MOTOR GROUP LLC</td>
      <td>Secondhand Dealer Auto - 005</td>
      <td>Damaged Goods - D01</td>
      <td>8/15/2019</td>
      <td>8/20/2019</td>
      <td>NaN</td>
      <td>0</td>
      <td>NY</td>
    </tr>
    <tr>
      <td>17</td>
      <td>COHEN&#39;S FASHION OPTICAL OF AMERICA INC</td>
      <td>Retail Store - 820</td>
      <td>NaN</td>
      <td>5/8/2019</td>
      <td>6/27/2019</td>
      <td>NaN</td>
      <td>0</td>
      <td>NY</td>
    </tr>
    <tr>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <td>2741</td>
      <td>WATSON&#39;S PLUMBING &amp; HEATING INC.</td>
      <td>Other</td>
      <td>Misrepresentation - M01</td>
      <td>7/30/2019</td>
      <td>8/19/2019</td>
      <td>NaN</td>
      <td>0</td>
      <td>NY</td>
    </tr>
    <tr>
      <td>2754</td>
      <td>BOB&#39;S DISCOUNT FURNITURE, LLC</td>
      <td>Furniture Sales - 242</td>
      <td>Damaged Goods - D01</td>
      <td>9/12/2019</td>
      <td>10/7/2019</td>
      <td>NaN</td>
      <td>0</td>
      <td>CT</td>
    </tr>
    <tr>
      <td>2758</td>
      <td>NEW YORK &amp; COMPANY</td>
      <td>Retail Store - 820</td>
      <td>Surcharge/Overcharge - S02</td>
      <td>10/1/2019</td>
      <td>10/11/2019</td>
      <td>NaN</td>
      <td>0</td>
      <td>NY</td>
    </tr>
    <tr>
      <td>2759</td>
      <td>SYLHET MOTORS INC.</td>
      <td>Secondhand Dealer Auto - 005</td>
      <td>Billing Dispute - B02</td>
      <td>5/28/2019</td>
      <td>6/5/2019</td>
      <td>NaN</td>
      <td>0</td>
      <td>NY</td>
    </tr>
    <tr>
      <td>2774</td>
      <td>MIG FURNITURE INC</td>
      <td>Furniture Sales - 242</td>
      <td>Advertising/Misleading - A02</td>
      <td>2/13/2019</td>
      <td>3/15/2019</td>
      <td>NaN</td>
      <td>0</td>
      <td>NY</td>
    </tr>
  </tbody>
</table>
<p>567 rows &#215; 8 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[442]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">Satisfaction</span><span class="o">.</span><span class="n">isnull</span><span class="p">()]</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[443]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[443]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(2225, 8)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[444]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">new_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[445]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#new_df = df.set_index(&#39;Business Name&#39;).join(new_charges.set_index(&#39;Business Name&#39;))  #join data sets</span>
<span class="c1">#new_df = pd.merge(left=df, right=new_charges, how=&#39;left&#39;, left_on=&#39;Business Name&#39;, right_on=&#39;Business Name&#39;)</span>
<span class="c1">#new_df = df.merge(new_charges,  how = &#39;left&#39; )</span>
<span class="c1">#new_df.columns</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[446]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#new_df.head(100)  </span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[447]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#new_df.shape</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[448]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#new_df[new_df[&#39;Charged&#39;] == 1]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Convert Restitution to float<a rel="noopener" class="anchor-link" href="#Convert-Restitution-to-float">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[449]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#need to convert Restitution to float but need to get rid of string record</span>
<span class="n">indexNames</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Restitution&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Yes&#39;</span> <span class="p">]</span><span class="o">.</span><span class="n">index</span>
<span class="nb">print</span><span class="p">(</span><span class="n">indexNames</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">indexNames</span> <span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Int64Index([318], dtype=&#39;int64&#39;)
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt output_prompt">Out[449]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(2224, 8)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[450]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#df.dropna(inplace = True) </span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Restitution&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Restitution&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span> 
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Convert categorical variables to string<a rel="noopener" class="anchor-link" href="#Convert-categorical-variables-to-string">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[451]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Industry&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Industry&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span> 
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Complaint Type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Complaint Type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span> 
<span class="c1">#df[&#39;Complaint Result&#39;] = df[&#39;Complaint Result&#39;].astype(&#39;category&#39;)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Business State&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Business State&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[452]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Mediation Start Date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Mediation Start Date&#39;</span><span class="p">])</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Mediation Close Date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Mediation Close Date&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[453]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Int64Index: 2224 entries, 0 to 2791
Data columns (total 8 columns):
Business Name           2197 non-null object
Industry                2224 non-null category
Complaint Type          2087 non-null category
Mediation Start Date    2224 non-null datetime64[ns]
Mediation Close Date    2224 non-null datetime64[ns]
Satisfaction            2224 non-null object
Restitution             2224 non-null float64
Business State          2182 non-null category
dtypes: category(3), datetime64[ns](2), float64(1), object(2)
memory usage: 116.9+ KB
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[454]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[454]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Business Name</th>
      <th>Industry</th>
      <th>Complaint Type</th>
      <th>Mediation Start Date</th>
      <th>Mediation Close Date</th>
      <th>Satisfaction</th>
      <th>Restitution</th>
      <th>Business State</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>MAJOR WORLD CHEVROLET, L.L.C.</td>
      <td>Secondhand Dealer Auto - 005</td>
      <td>Damaged Goods - D01</td>
      <td>2019-04-26</td>
      <td>2019-05-09</td>
      <td>No</td>
      <td>0.0</td>
      <td>NY</td>
    </tr>
    <tr>
      <td>1</td>
      <td>CYPRESS MOTORS OF RIDGEWOOD INC,</td>
      <td>Secondhand Dealer Auto - 005</td>
      <td>Lemon</td>
      <td>2019-04-11</td>
      <td>2019-05-22</td>
      <td>Yes</td>
      <td>2400.0</td>
      <td>NY</td>
    </tr>
    <tr>
      <td>2</td>
      <td>FINEST AUTOMOTIVE RECOVERY INC</td>
      <td>Tow Truck Company - 124</td>
      <td>Billing Dispute - B02</td>
      <td>2019-04-10</td>
      <td>2019-05-07</td>
      <td>Yes</td>
      <td>60.0</td>
      <td>NY</td>
    </tr>
    <tr>
      <td>3</td>
      <td>U NICE LAUNDRY INC</td>
      <td>Laundry - 064</td>
      <td>Refund Policy - R01</td>
      <td>2019-11-25</td>
      <td>2019-12-10</td>
      <td>Yes</td>
      <td>4.0</td>
      <td>NY</td>
    </tr>
    <tr>
      <td>6</td>
      <td>S + A REMODELLING INC.</td>
      <td>Home Improvement Contractor - 100</td>
      <td>Refund Policy - R01</td>
      <td>2019-03-05</td>
      <td>2019-04-08</td>
      <td>Yes</td>
      <td>10900.0</td>
      <td>NY</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Convert categorical to ssf<a rel="noopener" class="anchor-link" href="#Convert-categorical-to-ssf">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[455]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># split each category into SSF to later to merge back to dfcopy </span>
<span class="n">df_ssfIndustry</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Industry&#39;</span><span class="p">])</span>
<span class="n">df_ssfCompType</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Complaint Type&#39;</span><span class="p">])</span>
<span class="c1">#df_ssfCompResult = pd.get_dummies(df[&#39;Complaint Result&#39;])</span>
<span class="n">df_ssfBusState</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Business State&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[456]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#### make a copy of df so we don&#39;t affect the df stats and visualizations</span>
<span class="n">dfcopy</span> <span class="o">=</span> <span class="n">df</span>
<span class="c1">#dfcopy = dfcopy.drop(columns=[&#39;Industry&#39;, &#39;Complaint Type&#39;, &#39;Complaint Result&#39;, &#39;Business State&#39;])</span>
<span class="n">dfcopy</span> <span class="o">=</span> <span class="n">dfcopy</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Industry&#39;</span><span class="p">,</span> <span class="s1">&#39;Complaint Type&#39;</span><span class="p">,</span> <span class="s1">&#39;Business State&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[457]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">dfcopy</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">dfcopy</span><span class="p">,</span> <span class="n">df_ssfIndustry</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">dfcopy</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[458]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">dfcopy</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">dfcopy</span><span class="p">,</span> <span class="n">df_ssfCompType</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">dfcopy</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[459]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#dfcopy = pd.concat([dfcopy, df_ssfCompResult], axis=1).reindex(dfcopy.index)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[460]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">dfcopy</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">dfcopy</span><span class="p">,</span> <span class="n">df_ssfBusState</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">dfcopy</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[461]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">dfcopy</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[461]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Business Name</th>
      <th>Mediation Start Date</th>
      <th>Mediation Close Date</th>
      <th>Satisfaction</th>
      <th>Restitution</th>
      <th>Appliances - 244</th>
      <th>Auction House - 128</th>
      <th>Auto Dealership - 212</th>
      <th>Auto Leasing - 211</th>
      <th>Auto Rental - 213</th>
      <th>...</th>
      <th>OH</th>
      <th>PA</th>
      <th>RI</th>
      <th>SC</th>
      <th>TN</th>
      <th>TX</th>
      <th>UT</th>
      <th>VA</th>
      <th>WA</th>
      <th>WI</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>MAJOR WORLD CHEVROLET, L.L.C.</td>
      <td>2019-04-26</td>
      <td>2019-05-09</td>
      <td>No</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>1</td>
      <td>CYPRESS MOTORS OF RIDGEWOOD INC,</td>
      <td>2019-04-11</td>
      <td>2019-05-22</td>
      <td>Yes</td>
      <td>2400.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>2</td>
      <td>FINEST AUTOMOTIVE RECOVERY INC</td>
      <td>2019-04-10</td>
      <td>2019-05-07</td>
      <td>Yes</td>
      <td>60.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>3</td>
      <td>U NICE LAUNDRY INC</td>
      <td>2019-11-25</td>
      <td>2019-12-10</td>
      <td>Yes</td>
      <td>4.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>6</td>
      <td>S + A REMODELLING INC.</td>
      <td>2019-03-05</td>
      <td>2019-04-08</td>
      <td>Yes</td>
      <td>10900.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows &#215; 144 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[462]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">dfcopy</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[462]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(2224, 144)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[463]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Drop irrelevant columns</span>
<span class="c1">#dfcopy.drop([&#39;Business Building&#39;], axis=1)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[464]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">dfcopy</span><span class="o">.</span><span class="n">columns</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[464]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>Index([&#39;Business Name&#39;, &#39;Mediation Start Date&#39;, &#39;Mediation Close Date&#39;,
       &#39;Satisfaction&#39;, &#39;Restitution&#39;, &#39;Appliances - 244&#39;,
       &#39;Auction House - 128&#39;, &#39;Auto Dealership - 212&#39;, &#39;Auto Leasing - 211&#39;,
       &#39;Auto Rental - 213&#39;,
       ...
       &#39;OH&#39;, &#39;PA&#39;, &#39;RI&#39;, &#39;SC&#39;, &#39;TN&#39;, &#39;TX&#39;, &#39;UT&#39;, &#39;VA&#39;, &#39;WA&#39;, &#39;WI&#39;],
      dtype=&#39;object&#39;, length=144)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[465]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">dfcopy</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Int64Index: 2224 entries, 0 to 2791
Columns: 144 entries, Business Name to WI
dtypes: datetime64[ns](2), float64(1), object(2), uint8(139)
memory usage: 406.1+ KB
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[466]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#dfcopy.drop([&#39;Business Building&#39;], axis=1, inplace=True )</span>
<span class="c1">#dfcopy.drop([&#39;Building Address Unit&#39;], axis=1, inplace=True)</span>
<span class="c1">#dfcopy.drop([&#39;Business City&#39;], axis=1, inplace=True)</span>
<span class="c1">#dfcopy.drop([&#39;Business Zip&#39;], axis=1, inplace=True)</span>
<span class="c1">#dfcopy.drop([&#39;Business Street&#39;], axis=1, inplace=True)</span>
<span class="c1">#dfcopy.drop([&#39;Longitude&#39;], axis=1, inplace=True)</span>
<span class="c1">#dfcopy.drop([&#39;Latitude&#39;], axis=1, inplace=True)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[467]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#dfcopy.drop([&#39;Complainant Zip&#39;], axis=1, inplace=True)</span>
<span class="n">dfcopy</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[467]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Business Name</th>
      <th>Mediation Start Date</th>
      <th>Mediation Close Date</th>
      <th>Satisfaction</th>
      <th>Restitution</th>
      <th>Appliances - 244</th>
      <th>Auction House - 128</th>
      <th>Auto Dealership - 212</th>
      <th>Auto Leasing - 211</th>
      <th>Auto Rental - 213</th>
      <th>...</th>
      <th>OH</th>
      <th>PA</th>
      <th>RI</th>
      <th>SC</th>
      <th>TN</th>
      <th>TX</th>
      <th>UT</th>
      <th>VA</th>
      <th>WA</th>
      <th>WI</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>MAJOR WORLD CHEVROLET, L.L.C.</td>
      <td>2019-04-26</td>
      <td>2019-05-09</td>
      <td>No</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>1</td>
      <td>CYPRESS MOTORS OF RIDGEWOOD INC,</td>
      <td>2019-04-11</td>
      <td>2019-05-22</td>
      <td>Yes</td>
      <td>2400.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>2</td>
      <td>FINEST AUTOMOTIVE RECOVERY INC</td>
      <td>2019-04-10</td>
      <td>2019-05-07</td>
      <td>Yes</td>
      <td>60.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>3 rows &#215; 144 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Combine df and df_matrix<a rel="noopener" class="anchor-link" href="#Combine-df-and-df_matrix">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1>General Descriptive Statistics<a rel="noopener" class="anchor-link" href="#General-Descriptive-Statistics">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Data Visualization<a rel="noopener" class="anchor-link" href="#Data-Visualization">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[468]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Distribution of count by satisfaction</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;Satisfaction&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[468]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x1a230c2d10&gt;</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea">
<img src="javascript://"/>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[469]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Distribution of count by satisfaction</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;Business State&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[469]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x1a1d9b33d0&gt;</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea">
<img src="javascript://"/>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[470]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Percentage Distribution by Industry and by Complaint Type</span>
<span class="n">temp1</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Industry&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">/</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Industry&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="n">temp2</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Complaint Type&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">/</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Complaint Type&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="n">temp2</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Industry&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Percentage&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Industry Distribution&quot;</span><span class="p">)</span>
<span class="n">temp1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">grid</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Complaint Type&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Percentage&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Complaint Type Distribution&quot;</span><span class="p">)</span>
<span class="n">temp2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">grid</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[470]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x1a1ddeed50&gt;</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea">
<img src="javascript://"/>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[471]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Count of Complaints by Industry</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;Industry&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[471]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x1a1da2a890&gt;</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea">
<img src="javascript://"/>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[472]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Count of Complaints by Type</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;Complaint Type&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[472]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x1a23733c10&gt;</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea">
<img src="javascript://"/>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[473]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># restitution amounts are skewed</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;Restitution&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[473]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>count     2224.000000
mean       416.788669
std       2635.218632
min          0.000000
25%          0.000000
50%          0.000000
75%         62.250000
max      71928.000000
Name: Restitution, dtype: float64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[474]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Restitution distribution</span>
<span class="n">df</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Restitution&quot;</span><span class="p">],</span> <span class="n">return_type</span><span class="o">=</span><span class="s1">&#39;axes&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[474]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x1a22272a50&gt;</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea">
<img src="javascript://"/>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[475]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3000</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> <span class="c1"># this doesn&#39;t look consistent with the describe, which shows that 75% are 0</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Restitution&quot;</span><span class="p">],</span> <span class="n">bins</span> <span class="o">=</span> <span class="mi">7</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;amounts&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;frequency&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Distribution of payouts&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[475]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&lt;function matplotlib.pyplot.show(*args, **kw)&gt;</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea">
<img src="javascript://"/>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[476]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Restitution&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[476]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>count     2224.000000
mean       416.788669
std       2635.218632
min          0.000000
25%          0.000000
50%          0.000000
75%         62.250000
max      71928.000000
Name: Restitution, dtype: float64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Data Exploration<a rel="noopener" class="anchor-link" href="#Data-Exploration">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[477]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[477]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Restitution</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>count</td>
      <td>2224.000000</td>
    </tr>
    <tr>
      <td>mean</td>
      <td>416.788669</td>
    </tr>
    <tr>
      <td>std</td>
      <td>2635.218632</td>
    </tr>
    <tr>
      <td>min</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <td>25%</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <td>50%</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <td>75%</td>
      <td>62.250000</td>
    </tr>
    <tr>
      <td>max</td>
      <td>71928.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[478]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">dfcopy</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[478]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Restitution</th>
      <th>Appliances - 244</th>
      <th>Auction House - 128</th>
      <th>Auto Dealership - 212</th>
      <th>Auto Leasing - 211</th>
      <th>Auto Rental - 213</th>
      <th>Booting Company - 126</th>
      <th>Car Wash</th>
      <th>Catering Establishment - 075</th>
      <th>Dealer In Products For The Disabled - 119</th>
      <th>...</th>
      <th>OH</th>
      <th>PA</th>
      <th>RI</th>
      <th>SC</th>
      <th>TN</th>
      <th>TX</th>
      <th>UT</th>
      <th>VA</th>
      <th>WA</th>
      <th>WI</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>count</td>
      <td>2224.000000</td>
      <td>2224.000000</td>
      <td>2224.000000</td>
      <td>2224.000000</td>
      <td>2224.000000</td>
      <td>2224.000000</td>
      <td>2224.000000</td>
      <td>2224.000000</td>
      <td>2224.000000</td>
      <td>2224.000000</td>
      <td>...</td>
      <td>2224.000000</td>
      <td>2224.000000</td>
      <td>2224.000000</td>
      <td>2224.000000</td>
      <td>2224.000000</td>
      <td>2224.000000</td>
      <td>2224.000000</td>
      <td>2224.000000</td>
      <td>2224.000000</td>
      <td>2224.000000</td>
    </tr>
    <tr>
      <td>mean</td>
      <td>416.788669</td>
      <td>0.018435</td>
      <td>0.004047</td>
      <td>0.000450</td>
      <td>0.000450</td>
      <td>0.006295</td>
      <td>0.001349</td>
      <td>0.001349</td>
      <td>0.000899</td>
      <td>0.000450</td>
      <td>...</td>
      <td>0.004496</td>
      <td>0.012140</td>
      <td>0.001349</td>
      <td>0.003147</td>
      <td>0.001799</td>
      <td>0.017086</td>
      <td>0.002248</td>
      <td>0.005845</td>
      <td>0.008993</td>
      <td>0.010342</td>
    </tr>
    <tr>
      <td>std</td>
      <td>2635.218632</td>
      <td>0.134549</td>
      <td>0.063500</td>
      <td>0.021205</td>
      <td>0.021205</td>
      <td>0.079108</td>
      <td>0.036711</td>
      <td>0.036711</td>
      <td>0.029981</td>
      <td>0.021205</td>
      <td>...</td>
      <td>0.066919</td>
      <td>0.109537</td>
      <td>0.036711</td>
      <td>0.056027</td>
      <td>0.042381</td>
      <td>0.129622</td>
      <td>0.047373</td>
      <td>0.076248</td>
      <td>0.094424</td>
      <td>0.101190</td>
    </tr>
    <tr>
      <td>min</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <td>25%</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <td>50%</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <td>75%</td>
      <td>62.250000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <td>max</td>
      <td>71928.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>...</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
<p>8 rows &#215; 140 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2>Split Data<a rel="noopener" class="anchor-link" href="#Split-Data">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Putting back the split<a rel="noopener" class="anchor-link" href="#Putting-back-the-split">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[479]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># drop time series</span>
<span class="n">dfcopy</span> <span class="o">=</span> <span class="n">dfcopy</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Mediation Start Date&#39;</span><span class="p">])</span>
<span class="n">dfcopy</span> <span class="o">=</span> <span class="n">dfcopy</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Mediation Close Date&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[480]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># drop target colum </span>
<span class="n">dfcopy</span> <span class="o">=</span> <span class="n">dfcopy</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Satisfaction&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[481]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">dfcopy</span> <span class="o">=</span> <span class="n">dfcopy</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Business Name&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[482]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df_target</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Satisfaction&quot;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[483]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="n">df_train</span><span class="p">,</span> <span class="n">df_test</span><span class="p">,</span> <span class="n">df_target_train</span><span class="p">,</span> <span class="n">df_target_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">dfcopy</span><span class="p">,</span> <span class="n">df_target</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">33</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>KNN Model<a rel="noopener" class="anchor-link" href="#KNN-Model">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[484]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">neighbors</span><span class="p">,</span> <span class="n">tree</span><span class="p">,</span> <span class="n">naive_bayes</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[485]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#create the object</span>
<span class="n">n_neighbors</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">knnclf</span> <span class="o">=</span> <span class="n">neighbors</span><span class="o">.</span><span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="s1">&#39;distance&#39;</span><span class="p">)</span>
<span class="n">knnclf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df_train</span><span class="p">,</span> <span class="n">df_target_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[485]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>KNeighborsClassifier(algorithm=&#39;auto&#39;, leaf_size=30, metric=&#39;minkowski&#39;,
                     metric_params=None, n_jobs=None, n_neighbors=10, p=2,
                     weights=&#39;distance&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[486]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">knnpreds_test</span> <span class="o">=</span> <span class="n">knnclf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">df_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">knnpreds_test</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>[&#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39;
 &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39;
 &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39;
 &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39;
 &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39;
 &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39;
 &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39;
 &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39;
 &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39;
 &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39;
 &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39;
 &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39;
 &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39;
 &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39;
 &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39;
 &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39;
 &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39;
 &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39;
 &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39;
 &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39;
 &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39;
 &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39;
 &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39;
 &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39;
 &#39;Yes&#39;]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[487]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">classification_report</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[488]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">df_target_test</span><span class="p">,</span> <span class="n">knnpreds_test</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>              precision    recall  f1-score   support

          No       0.67      0.87      0.75       177
         Yes       0.89      0.71      0.79       268

    accuracy                           0.78       445
   macro avg       0.78      0.79      0.77       445
weighted avg       0.80      0.78      0.78       445

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[489]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">knncm</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">df_target_test</span><span class="p">,</span> <span class="n">knnpreds_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">knncm</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>[[154  23]
 [ 77 191]]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[490]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">knnclf</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">df_test</span><span class="p">,</span> <span class="n">df_target_test</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>0.7752808988764045
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[491]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">### Plot the confusion matrix</span>

<span class="kn">import</span> <span class="nn">pylab</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">plt</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">knncm</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Confusion matrix for KNN&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Actual&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Predicted&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea">
<img src="javascript://"/>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5>Decision Tree<a rel="noopener" class="anchor-link" href="#Decision-Tree">&#182;</a></h5>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[492]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">treeclf</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">criterion</span><span class="o">=</span> <span class="s1">&#39;gini&#39;</span><span class="p">,</span> <span class="n">max_leaf_nodes</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span> <span class="c1">#max_leaf_nodes</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[493]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">treeclf</span> <span class="o">=</span> <span class="n">treeclf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df_train</span><span class="p">,</span> <span class="n">df_target_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[494]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">treepreds_test</span> <span class="o">=</span> <span class="n">treeclf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">df_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">treepreds_test</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>[&#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39;
 &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39;
 &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39;
 &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39;
 &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39;
 &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39;
 &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39;
 &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39;
 &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39;
 &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39;
 &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39;
 &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39;
 &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39;
 &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39;
 &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39;
 &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39;
 &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39;
 &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39;
 &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39;
 &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39;
 &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39;
 &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39;
 &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39;
 &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39;
 &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39;
 &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39;
 &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39;
 &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39;
 &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39;
 &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39;]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[495]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">treeclf</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">df_test</span><span class="p">,</span> <span class="n">df_target_test</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>0.7685393258426966
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[496]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">treeclf</span><span class="o">.</span><span class="n">get_depth</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">treeclf</span><span class="o">.</span><span class="n">get_n_leaves</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">treeclf</span><span class="o">.</span><span class="n">get_params</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>7
10
&lt;bound method BaseEstimator.get_params of DecisionTreeClassifier(ccp_alpha=0.0, class_weight=None, criterion=&#39;gini&#39;,
                       max_depth=None, max_features=None, max_leaf_nodes=10,
                       min_impurity_decrease=0.0, min_impurity_split=None,
                       min_samples_leaf=1, min_samples_split=2,
                       min_weight_fraction_leaf=0.0, presort=&#39;deprecated&#39;,
                       random_state=None, splitter=&#39;best&#39;)&gt;
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[497]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_val_score</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[498]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">cv_scores</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">treeclf</span><span class="p">,</span> <span class="n">df_test</span><span class="p">,</span> <span class="n">df_target_test</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cv_scores</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>[0.73333333 0.8        0.75555556 0.77777778 0.75555556 0.84090909
 0.72727273 0.68181818 0.72727273 0.81818182]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[499]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">treeclf</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">df_train</span><span class="p">,</span> <span class="n">df_target_train</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>0.7807757166947723
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[500]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">df_target_test</span><span class="p">,</span> <span class="n">treepreds_test</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>              precision    recall  f1-score   support

          No       0.65      0.92      0.76       177
         Yes       0.93      0.67      0.78       268

    accuracy                           0.77       445
   macro avg       0.79      0.79      0.77       445
weighted avg       0.82      0.77      0.77       445

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[501]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">treecm</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">df_target_test</span><span class="p">,</span> <span class="n">treepreds_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">treecm</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>[[163  14]
 [ 89 179]]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[502]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">### Plot the confusion matrix</span>

<span class="kn">import</span> <span class="nn">pylab</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">plt</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">treecm</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Confusion matrix fo Decision Tree&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Actual&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Predicted&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea">
<img src="javascript://"/>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[503]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">### Visualizing the Tree</span>
<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">export_graphviz</span>

<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">SVG</span>
<span class="kn">from</span> <span class="nn">graphviz</span> <span class="kn">import</span> <span class="n">Source</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span>

<span class="c1">#which one do we put first, yes or no for the class names</span>
<span class="n">tree</span> <span class="o">=</span> <span class="n">export_graphviz</span><span class="p">(</span><span class="n">treeclf</span><span class="p">,</span> <span class="n">out_file</span><span class="o">=</span><span class="s1">&#39;tree.html&#39;</span><span class="p">,</span> <span class="n">feature_names</span><span class="o">=</span><span class="n">df_train</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">class_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;No&#39;</span><span class="p">,</span><span class="s1">&#39;Yes&#39;</span><span class="p">])</span>
<span class="kn">import</span> <span class="nn">graphviz</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;tree.html&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">dot_graph</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="n">graphviz</span><span class="o">.</span><span class="n">Source</span><span class="p">(</span><span class="n">dot_graph</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;png&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[503]:</div>



<div class="output_svg output_subarea output_execute_result">












Restitution &lt;= 1.5
gini = 0.479
samples = 1779
value = [706, 1073]
class = Yes





Debt Collection Agency - 122 &lt;= 0.5
gini = 0.488
samples = 1224
value = [706, 518]
class = No






True





gini = 0.0
samples = 555
value = [0, 555]
class = Yes






False





Home Improvement Contractor - 100 &lt;= 0.5
gini = 0.471
samples = 1138
value = [705, 433]
class = No











gini = 0.023
samples = 86
value = [1, 85]
class = Yes











NY &lt;= 0.5
gini = 0.491
samples = 859
value = [488, 371]
class = No











NY &lt;= 0.5
gini = 0.346
samples = 279
value = [217, 62]
class = No











Damaged Goods - D01 &lt;= 0.5
gini = 0.491
samples = 148
value = [64, 84]
class = Yes











Supermarket - 819 &lt;= 0.5
gini = 0.481
samples = 711
value = [424, 287]
class = No











gini = 0.477
samples = 130
value = [51, 79]
class = Yes











gini = 0.401
samples = 18
value = [13, 5]
class = No











Restaurant - 818 &lt;= 0.5
gini = 0.478
samples = 700
value = [423, 277]
class = No











gini = 0.165
samples = 11
value = [1, 10]
class = Yes











Tow Truck Company - 124 &lt;= 0.5
gini = 0.475
samples = 685
value = [419, 266]
class = No











gini = 0.391
samples = 15
value = [4, 11]
class = Yes











gini = 0.481
samples = 615
value = [367, 248]
class = No











gini = 0.382
samples = 70
value = [52, 18]
class = No











gini = 0.5
samples = 20
value = [10, 10]
class = No











gini = 0.321
samples = 259
value = [207, 52]
class = No










</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[504]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#display(SVG(graph.pipe(format=&#39;svg&#39;)))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Grid Search for best Dec Tree parameters<a rel="noopener" class="anchor-link" href="#Grid-Search-for-best-Dec-Tree-parameters">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[505]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">tree</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_val_score</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[506]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">dt</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">DecisionTreeClassifier</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[507]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;criterion&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;entropy&#39;</span><span class="p">,</span><span class="s1">&#39;gini&#39;</span><span class="p">],</span>
    <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">),</span>
    <span class="s1">&#39;min_samples_leaf&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">),</span>
    <span class="s1">&#39;min_samples_split&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">),</span> 
    <span class="s1">&#39;max_leaf_nodes&#39;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">),</span>
    
<span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[508]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">gs</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[509]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">time</span> _ = gs.fit(df_train, df_target_train)

<span class="n">gs</span><span class="o">.</span><span class="n">best_params_</span><span class="p">,</span> <span class="n">gs</span><span class="o">.</span><span class="n">best_score_</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Fitting 5 folds for each of 6000 candidates, totalling 30000 fits
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 5min 34s, sys: 2.23 s, total: 5min 36s
Wall time: 5min 37s
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>[Parallel(n_jobs=1)]: Done 30000 out of 30000 | elapsed:  5.6min finished
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt output_prompt">Out[509]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>({&#39;criterion&#39;: &#39;entropy&#39;,
  &#39;max_depth&#39;: 7,
  &#39;max_leaf_nodes&#39;: 7,
  &#39;min_samples_leaf&#39;: 30,
  &#39;min_samples_split&#39;: 10},
 0.773486311125178)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[510]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># using best parameters from the above grid search results.</span>
<span class="n">treeclfOpt</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">criterion</span><span class="o">=</span> <span class="s1">&#39;entropy&#39;</span><span class="p">,</span> <span class="n">max_leaf_nodes</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span> <span class="n">max_depth</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span> <span class="n">min_samples_leaf</span><span class="o">=</span> <span class="mi">30</span><span class="p">,</span> <span class="n">min_samples_split</span><span class="o">=</span> <span class="mi">10</span><span class="p">)</span> <span class="c1">#max_leaf_nodes</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[511]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">treeclfOpt</span> <span class="o">=</span> <span class="n">treeclfOpt</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df_train</span><span class="p">,</span> <span class="n">df_target_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[512]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">treepreds_test</span> <span class="o">=</span> <span class="n">treeclfOpt</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">df_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">treepreds_test</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>[&#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39;
 &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39;
 &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39;
 &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39;
 &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39;
 &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39;
 &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39;
 &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39;
 &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39;
 &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39;
 &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39;
 &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39;
 &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39;
 &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39;
 &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39;
 &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39;
 &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39;
 &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39;
 &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39;
 &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39;
 &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39;
 &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39;
 &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39;
 &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39;
 &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39;
 &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39;
 &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39;]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[513]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">treeclfOpt</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">df_test</span><span class="p">,</span> <span class="n">df_target_test</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>0.7842696629213484
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[514]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">cv_scores</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">treeclfOpt</span><span class="p">,</span> <span class="n">df_test</span><span class="p">,</span> <span class="n">df_target_test</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cv_scores</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>[0.73333333 0.82222222 0.77777778 0.75555556 0.71111111 0.81818182
 0.75       0.63636364 0.72727273 0.86363636]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[515]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">treeclfOpt</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">df_train</span><span class="p">,</span> <span class="n">df_target_train</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>0.7740303541315345
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[516]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">df_target_test</span><span class="p">,</span> <span class="n">treepreds_test</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>              precision    recall  f1-score   support

          No       0.67      0.89      0.77       177
         Yes       0.91      0.71      0.80       268

    accuracy                           0.78       445
   macro avg       0.79      0.80      0.78       445
weighted avg       0.82      0.78      0.79       445

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[517]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">treecm</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">df_target_test</span><span class="p">,</span> <span class="n">treepreds_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">treecm</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>[[158  19]
 [ 77 191]]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[518]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">### Plot the confusion matrix</span>

<span class="kn">import</span> <span class="nn">pylab</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">plt</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">treecm</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Confusion matrix fo Decision Tree&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Actual&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Predicted&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea">
<img src="javascript://"/>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[519]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">### Visualizing the Tree</span>
<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">export_graphviz</span>

<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">SVG</span>
<span class="kn">from</span> <span class="nn">graphviz</span> <span class="kn">import</span> <span class="n">Source</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span>

<span class="c1">#which one do we put first, yes or no for the class names</span>
<span class="n">tree</span> <span class="o">=</span> <span class="n">export_graphviz</span><span class="p">(</span><span class="n">treeclfOpt</span><span class="p">,</span> <span class="n">out_file</span><span class="o">=</span><span class="s1">&#39;tree.html&#39;</span><span class="p">,</span> <span class="n">feature_names</span><span class="o">=</span><span class="n">df_train</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">class_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;No&#39;</span><span class="p">,</span><span class="s1">&#39;Yes&#39;</span><span class="p">])</span>
<span class="kn">import</span> <span class="nn">graphviz</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;tree.html&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">dot_graph</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="n">graphviz</span><span class="o">.</span><span class="n">Source</span><span class="p">(</span><span class="n">dot_graph</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;png&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[519]:</div>



<div class="output_svg output_subarea output_execute_result">












Restitution &lt;= 1.5
entropy = 0.969
samples = 1779
value = [706, 1073]
class = Yes





Debt Collection Agency - 122 &lt;= 0.5
entropy = 0.983
samples = 1224
value = [706, 518]
class = No






True





entropy = 0.0
samples = 555
value = [0, 555]
class = Yes






False





Home Improvement Contractor - 100 &lt;= 0.5
entropy = 0.958
samples = 1138
value = [705, 433]
class = No











entropy = 0.091
samples = 86
value = [1, 85]
class = Yes











NY &lt;= 0.5
entropy = 0.987
samples = 859
value = [488, 371]
class = No











entropy = 0.764
samples = 279
value = [217, 62]
class = No











entropy = 0.987
samples = 148
value = [64, 84]
class = Yes











Tow Truck Company - 124 &lt;= 0.5
entropy = 0.973
samples = 711
value = [424, 287]
class = No











Surcharge/Overcharge - S02 &lt;= 0.5
entropy = 0.981
samples = 641
value = [372, 269]
class = No











entropy = 0.822
samples = 70
value = [52, 18]
class = No











entropy = 0.971
samples = 571
value = [343, 228]
class = No











entropy = 0.979
samples = 70
value = [29, 41]
class = Yes










</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[520]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">### Analysis why did Grid Seafch select the </span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Adding Duration column based on Mediation Close and Start dates<a rel="noopener" class="anchor-link" href="#Adding-Duration-column-based-on-Mediation-Close-and-Start-dates">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[&#160;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[521]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span> <span class="k">as</span> <span class="n">dt</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[522]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Int64Index: 2224 entries, 0 to 2791
Data columns (total 8 columns):
Business Name           2197 non-null object
Industry                2224 non-null category
Complaint Type          2087 non-null category
Mediation Start Date    2224 non-null datetime64[ns]
Mediation Close Date    2224 non-null datetime64[ns]
Satisfaction            2224 non-null object
Restitution             2224 non-null float64
Business State          2182 non-null category
dtypes: category(3), datetime64[ns](2), float64(1), object(2)
memory usage: 116.9+ KB
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[523]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">duration</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Mediation Close Date&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Mediation Start Date&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[524]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#duration = pd.DataFrame(duration)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[525]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">duration</span> <span class="o">=</span> <span class="n">duration</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">days</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[526]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">duration</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[526]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(2224,)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[527]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">duration</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[527]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0     13
1     41
2     27
3     15
6     34
8     37
9     29
10    31
11     3
13    46
dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[528]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">duration</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[528]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>count    2224.000000
mean       26.214029
std        14.759888
min       -43.000000
25%        15.000000
50%        24.000000
75%        36.000000
max        84.000000
dtype: float64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4>Create a copy of dfcopy and add duration<a rel="noopener" class="anchor-link" href="#Create-a-copy-of-dfcopy-and-add-duration">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[529]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">dfcopyWithDuration</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">dfcopy</span><span class="p">,</span> <span class="n">duration</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">dfcopy</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[530]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">dfcopyWithDuration</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[530]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(2224, 141)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2>ReRun KNN with the dfcopyWithDuraction to see if the accuracy goes up with Duration<a rel="noopener" class="anchor-link" href="#ReRun-KNN-with-the-dfcopyWithDuraction-to-see-if-the-accuracy-goes-up-with-Duration">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[531]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="n">df_train</span><span class="p">,</span> <span class="n">df_test</span><span class="p">,</span> <span class="n">df_target_train</span><span class="p">,</span> <span class="n">df_target_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">dfcopyWithDuration</span><span class="p">,</span> <span class="n">df_target</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">df_test</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">df_test</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>(445, 141)
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt output_prompt">Out[531]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Restitution</th>
      <th>Appliances - 244</th>
      <th>Auction House - 128</th>
      <th>Auto Dealership - 212</th>
      <th>Auto Leasing - 211</th>
      <th>Auto Rental - 213</th>
      <th>Booting Company - 126</th>
      <th>Car Wash</th>
      <th>Catering Establishment - 075</th>
      <th>Dealer In Products For The Disabled - 119</th>
      <th>...</th>
      <th>PA</th>
      <th>RI</th>
      <th>SC</th>
      <th>TN</th>
      <th>TX</th>
      <th>UT</th>
      <th>VA</th>
      <th>WA</th>
      <th>WI</th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2772</td>
      <td>773.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>15</td>
    </tr>
    <tr>
      <td>1232</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>29</td>
    </tr>
    <tr>
      <td>658</td>
      <td>90.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>22</td>
    </tr>
    <tr>
      <td>879</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>40</td>
    </tr>
    <tr>
      <td>540</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>64</td>
    </tr>
  </tbody>
</table>
<p>5 rows &#215; 141 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[532]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">dfcopyWithDuration</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Int64Index: 2224 entries, 0 to 2791
Columns: 141 entries, Restitution to 0
dtypes: float64(1), int64(1), uint8(139)
memory usage: 354.0 KB
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[533]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#create the object</span>
<span class="n">n_neighbors</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">knnclf</span> <span class="o">=</span> <span class="n">neighbors</span><span class="o">.</span><span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="s1">&#39;distance&#39;</span><span class="p">)</span>
<span class="n">knnclf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df_train</span><span class="p">,</span> <span class="n">df_target_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[533]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>KNeighborsClassifier(algorithm=&#39;auto&#39;, leaf_size=30, metric=&#39;minkowski&#39;,
                     metric_params=None, n_jobs=None, n_neighbors=10, p=2,
                     weights=&#39;distance&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[534]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">knnpreds_test</span> <span class="o">=</span> <span class="n">knnclf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">df_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">knnpreds_test</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>[&#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39;
 &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39;
 &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39;
 &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39;
 &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39;
 &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39;
 &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39;
 &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39;
 &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39;
 &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39;
 &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39;
 &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39;
 &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39;
 &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39;
 &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39;
 &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39;
 &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39;
 &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39;
 &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39;
 &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39;
 &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;No&#39;
 &#39;No&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39; &#39;No&#39;
 &#39;No&#39; &#39;No&#39;]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[535]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">df_target_test</span><span class="p">,</span> <span class="n">knnpreds_test</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>              precision    recall  f1-score   support

          No       0.73      0.88      0.80       185
         Yes       0.90      0.77      0.83       260

    accuracy                           0.82       445
   macro avg       0.82      0.83      0.82       445
weighted avg       0.83      0.82      0.82       445

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[536]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">knncm</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">df_target_test</span><span class="p">,</span> <span class="n">knnpreds_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">knncm</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>[[163  22]
 [ 59 201]]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[537]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">knnclf</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">df_test</span><span class="p">,</span> <span class="n">df_target_test</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>0.8179775280898877
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[538]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">### Plot the confusion matrix</span>

<span class="kn">import</span> <span class="nn">pylab</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">plt</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">knncm</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Confusion matrix - KNN w/ duration&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Actual&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Predicted&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea">
<img src="javascript://"/>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Regression Analysis<a rel="noopener" class="anchor-link" href="#Regression-Analysis">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[539]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span><span class="p">,</span> <span class="n">Lasso</span><span class="p">,</span> <span class="n">Ridge</span><span class="p">,</span> <span class="n">ElasticNet</span><span class="p">,</span> <span class="n">SGDRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">preprocessing</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[540]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">min_max_scaler</span> <span class="o">=</span> <span class="n">preprocessing</span><span class="o">.</span><span class="n">MinMaxScaler</span><span class="p">()</span>
<span class="n">min_max_scaler</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[540]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>MinMaxScaler(copy=True, feature_range=(0, 1))</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[541]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df_train_norm</span> <span class="o">=</span> <span class="n">min_max_scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df_train</span><span class="p">)</span>
<span class="n">df_test_norm</span> <span class="o">=</span> <span class="n">min_max_scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df_test</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[542]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df_train_norm</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[542]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(1779, 141)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[543]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3000</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> <span class="c1"># this doesn&#39;t look consistent with the describe, which shows that 75% are 0</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df_train_norm</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">bins</span> <span class="o">=</span> <span class="mi">7</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;amounts&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;frequency&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Distribution of payouts&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[543]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&lt;function matplotlib.pyplot.show(*args, **kw)&gt;</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea">
<img src="javascript://"/>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[544]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Create linear regression object</span>
<span class="n">linreg</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[545]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">dfcopyWithDuration</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[545]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(2224,)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[546]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dfcopyWithDuration</span><span class="p">[</span><span class="s2">&quot;Restitution&quot;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[547]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dfcopyWithDuration</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[548]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="mi">2224</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[549]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">x1</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[549]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(2224, 1)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[550]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">v</span><span class="p">,[</span><span class="mi">1</span><span class="p">]))</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">x1</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[551]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">linreg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[551]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>LinearRegression(copy_X=True, fit_intercept=True, n_jobs=None, normalize=False)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[552]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">pred</span> <span class="o">=</span> <span class="n">linreg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x2</span><span class="p">[</span><span class="n">i</span><span class="p">]]))[</span><span class="mi">0</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%2d</span><span class="s2"> </span><span class="se">\t</span><span class="s2"> </span><span class="si">%2.2f</span><span class="s2"> </span><span class="se">\t</span><span class="s2"> </span><span class="si">%2.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">pred</span><span class="p">,</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre> 0 	 435.30 	 0.00
 1 	 396.07 	 2400.00
 2 	 415.69 	 60.00
 3 	 432.50 	 4.00
 4 	 405.88 	 10900.00
 5 	 401.68 	 0.00
 6 	 412.89 	 0.00
 7 	 410.08 	 0.00
 8 	 449.31 	 0.00
 9 	 389.07 	 0.00
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[553]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pylab</span> <span class="k">as</span> <span class="nn">pl</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[554]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Plot predicted against actual (in the training data)</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span><span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">50</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">50</span><span class="p">],</span> <span class="s1">&#39;g-&#39;</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x2&#39;</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea">
<img src="javascript://"/>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Distribution is too skewed for Linear Regression<a rel="noopener" class="anchor-link" href="#Distribution-is-too-skewed-for-Linear-Regression">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Clustering Model<a rel="noopener" class="anchor-link" href="#Clustering-Model">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[555]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">distCosSim</span><span class="p">(</span><span class="n">vecA</span><span class="p">,</span> <span class="n">vecB</span><span class="p">):</span>
    <span class="s1">&#39;&#39;</span>
    <span class="n">numDotproduct</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">vecA</span><span class="p">,</span> <span class="n">vecB</span><span class="p">)</span>
    <span class="n">vectAss</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">power</span><span class="p">(</span><span class="n">vecA</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
    <span class="n">vectBss</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">power</span><span class="p">(</span><span class="n">vecB</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
    <span class="n">CosSim</span> <span class="o">=</span> <span class="n">numDotproduct</span><span class="o">/</span><span class="p">(</span><span class="n">vectAss</span><span class="o">*</span><span class="n">vectBss</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">CosSim</span><span class="p">)</span> 
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[556]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">randCent</span><span class="p">(</span><span class="n">dataSet</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">shape</span><span class="p">(</span><span class="n">dataSet</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">centroids</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">((</span><span class="n">k</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span> <span class="c1">#create random cluster centers</span>
        <span class="n">minJ</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">dataSet</span><span class="p">[:,</span><span class="n">j</span><span class="p">])</span>
        <span class="n">rangeJ</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">dataSet</span><span class="p">[:,</span><span class="n">j</span><span class="p">])</span> <span class="o">-</span> <span class="n">minJ</span><span class="p">)</span>
        <span class="n">centroids</span><span class="p">[:,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">minJ</span> <span class="o">+</span> <span class="n">rangeJ</span> <span class="o">*</span> <span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">centroids</span> 
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[557]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">kMeans</span><span class="p">(</span><span class="n">dataSet</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">distMeas</span><span class="p">,</span> <span class="n">createCent</span><span class="o">=</span><span class="n">randCent</span><span class="p">):</span>
    <span class="s1">&#39;updated function to paramertize distMeasure&#39;</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">shape</span><span class="p">(</span><span class="n">dataSet</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">clusterAssment</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">((</span><span class="n">m</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="c1">#create mat to assign data points </span>
                                  <span class="c1">#to a centroid, also holds SE of each point</span>
    <span class="n">centroids</span> <span class="o">=</span> <span class="n">createCent</span><span class="p">(</span><span class="n">dataSet</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
    <span class="n">clusterChanged</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">while</span> <span class="n">clusterChanged</span><span class="p">:</span>
        <span class="n">clusterChanged</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span> <span class="c1">#for each data point assign it to the closest centroid</span>
            <span class="n">minDist</span> <span class="o">=</span> <span class="n">inf</span><span class="p">;</span> <span class="n">minIndex</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
                <span class="n">distJI</span> <span class="o">=</span> <span class="n">distMeas</span><span class="p">(</span><span class="n">centroids</span><span class="p">[</span><span class="n">j</span><span class="p">,:],</span><span class="n">dataSet</span><span class="p">[</span><span class="n">i</span><span class="p">,:])</span>
                <span class="k">if</span> <span class="n">distJI</span> <span class="o">&lt;</span> <span class="n">minDist</span><span class="p">:</span>
                    <span class="n">minDist</span> <span class="o">=</span> <span class="n">distJI</span><span class="p">;</span> <span class="n">minIndex</span> <span class="o">=</span> <span class="n">j</span>
            <span class="k">if</span> <span class="n">clusterAssment</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">minIndex</span><span class="p">:</span> <span class="n">clusterChanged</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">clusterAssment</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">minIndex</span><span class="p">,</span><span class="n">minDist</span><span class="o">**</span><span class="mi">2</span>
        <span class="c1"># print centroids</span>
        <span class="k">for</span> <span class="n">cent</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">):</span><span class="c1">#recalculate centroids</span>
            <span class="n">ptsInClust</span> <span class="o">=</span> <span class="n">dataSet</span><span class="p">[</span><span class="n">nonzero</span><span class="p">(</span><span class="n">clusterAssment</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="n">cent</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span> <span class="c1">#get all the point in this cluster - Note: this was incorrect in the original distribution.</span>
            <span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ptsInClust</span><span class="p">)</span><span class="o">!=</span><span class="mi">0</span><span class="p">):</span>
                <span class="n">centroids</span><span class="p">[</span><span class="n">cent</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">mean</span><span class="p">(</span><span class="n">ptsInClust</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1">#assign centroid to mean - Note condition was added 10/28/2013</span>
    <span class="k">return</span> <span class="n">centroids</span><span class="p">,</span> <span class="n">clusterAssment</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[558]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">dfcopyWithDuration</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[558]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Restitution</th>
      <th>Appliances - 244</th>
      <th>Auction House - 128</th>
      <th>Auto Dealership - 212</th>
      <th>Auto Leasing - 211</th>
      <th>Auto Rental - 213</th>
      <th>Booting Company - 126</th>
      <th>Car Wash</th>
      <th>Catering Establishment - 075</th>
      <th>Dealer In Products For The Disabled - 119</th>
      <th>...</th>
      <th>PA</th>
      <th>RI</th>
      <th>SC</th>
      <th>TN</th>
      <th>TX</th>
      <th>UT</th>
      <th>VA</th>
      <th>WA</th>
      <th>WI</th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>13</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2400.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>41</td>
    </tr>
    <tr>
      <td>2</td>
      <td>60.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>27</td>
    </tr>
    <tr>
      <td>3</td>
      <td>4.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>15</td>
    </tr>
    <tr>
      <td>6</td>
      <td>10900.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>34</td>
    </tr>
  </tbody>
</table>
<p>5 rows &#215; 141 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[559]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">dfcopyWithDurationArr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dfcopyWithDuration</span><span class="p">)</span>
<span class="n">df_targetArr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">df_target</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[560]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="n">df_train</span><span class="p">,</span> <span class="n">df_test</span><span class="p">,</span> <span class="n">df_target_train</span><span class="p">,</span> <span class="n">df_target_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">dfcopyWithDurationArr</span><span class="p">,</span> <span class="n">df_targetArr</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">df_test</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">df_test</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>(445, 141)
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt output_prompt">Out[560]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([[773.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
          0.,   0.,   0.,   1.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
          0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
          0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
          0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
          0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
          0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
          0.,   0.,   0.,   0.,   0.,   0.,   0.,   1.,   0.,   0.,   0.,
          0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
          0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
          0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   1.,   0.,   0.,
          0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
          0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  15.],
       [  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
          0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
          0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
          0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
          0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
          0.,   0.,   1.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
          0.,   0.,   0.,   0.,   0.,   0.,   0.,   1.,   0.,   0.,   0.,
          0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
          0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
          0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
          0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
          0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   1.,   0.,   0.,
          0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  29.],
       [ 90.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
          0.,   0.,   0.,   0.,   1.,   0.,   0.,   0.,   0.,   0.,   0.,
          0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
          0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
          0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
          0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
          0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
          0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
          0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
          0.,   1.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
          0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
          0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
          0.,   0.,   0.,   0.,   0.,   0.,   1.,   0.,  22.],
       [  0.,   0.,   0.,   0.,   0.,   1.,   0.,   0.,   0.,   0.,   0.,
          0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
          0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
          0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
          0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
          0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
          0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
          0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
          0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
          0.,   0.,   0.,   0.,   0.,   0.,   0.,   1.,   0.,   0.,   0.,
          0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
          0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
          0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  40.],
       [  0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
          0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
          0.,   0.,   0.,   0.,   0.,   1.,   0.,   0.,   0.,   0.,   0.,
          0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
          0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
          0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
          0.,   0.,   0.,   0.,   0.,   0.,   0.,   1.,   0.,   0.,   0.,
          0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
          0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
          0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
          0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,
          0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,   1.,   0.,   0.,
          0.,   0.,   0.,   0.,   0.,   0.,   0.,   0.,  64.]])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[561]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[562]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">dfcopyWithDurationArr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dfcopyWithDuration</span><span class="p">)</span>
<span class="n">df_targetArr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">df_target</span><span class="p">)</span>
<span class="n">df_trainArr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">df_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[563]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">cent</span><span class="p">,</span> <span class="n">clusAssmnt</span> <span class="o">=</span> <span class="n">kMeans</span><span class="p">(</span><span class="n">df_trainArr</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">distCosSim</span><span class="p">,</span> <span class="n">createCent</span><span class="o">=</span><span class="n">randCent</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[564]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;centroid&#39;</span><span class="p">,</span> <span class="n">cent</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>  <span class="s1">&#39;/n&#39;</span><span class="p">,</span> <span class="s1">&#39;cluster assment&#39;</span><span class="p">,</span><span class="n">clusAssmnt</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>centroid (3, 141) /n cluster assment (1779, 2)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[565]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">trainDF</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">df_train</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">dfcopyWithDuration</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[566]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">centDF</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">cent</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="n">dfcopyWithDuration</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>  <span class="c1">#cluster targets </span>
<span class="n">centDF</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[566]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Restitution</th>
      <th>Appliances - 244</th>
      <th>Auction House - 128</th>
      <th>Auto Dealership - 212</th>
      <th>Auto Leasing - 211</th>
      <th>Auto Rental - 213</th>
      <th>Booting Company - 126</th>
      <th>Car Wash</th>
      <th>Catering Establishment - 075</th>
      <th>Dealer In Products For The Disabled - 119</th>
      <th>...</th>
      <th>PA</th>
      <th>RI</th>
      <th>SC</th>
      <th>TN</th>
      <th>TX</th>
      <th>UT</th>
      <th>VA</th>
      <th>WA</th>
      <th>WI</th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.219025</td>
      <td>0.018385</td>
      <td>0.003197</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.003997</td>
      <td>0.000000</td>
      <td>0.002398</td>
      <td>0.001599</td>
      <td>0.000799</td>
      <td>...</td>
      <td>0.010392</td>
      <td>0.000799</td>
      <td>0.003997</td>
      <td>0.003197</td>
      <td>0.013589</td>
      <td>0.003197</td>
      <td>0.007194</td>
      <td>0.010392</td>
      <td>0.011990</td>
      <td>27.486011</td>
    </tr>
    <tr>
      <td>1</td>
      <td>97.593909</td>
      <td>0.005076</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.005076</td>
      <td>0.010152</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.020305</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.025381</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.010152</td>
      <td>0.000000</td>
      <td>24.263959</td>
    </tr>
    <tr>
      <td>2</td>
      <td>2075.927492</td>
      <td>0.024169</td>
      <td>0.012085</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.006042</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.021148</td>
      <td>0.003021</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.021148</td>
      <td>0.000000</td>
      <td>0.003021</td>
      <td>0.006042</td>
      <td>0.009063</td>
      <td>22.009063</td>
    </tr>
  </tbody>
</table>
<p>3 rows &#215; 141 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[567]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">NYCclusters</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">clusAssmnt</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Cluster&quot;</span><span class="p">,</span> <span class="s2">&quot;MinDistance**2&quot;</span><span class="p">])</span>
<span class="n">NYCclusters</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[567]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Cluster</th>
      <th>MinDistance**2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.0</td>
      <td>6.929363e-05</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2.0</td>
      <td>1.274995e-13</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.0</td>
      <td>7.876826e-06</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.0</td>
      <td>4.018297e-06</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0.0</td>
      <td>1.254728e-05</td>
    </tr>
    <tr>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <td>1774</td>
      <td>0.0</td>
      <td>1.493935e-03</td>
    </tr>
    <tr>
      <td>1775</td>
      <td>0.0</td>
      <td>5.670425e-07</td>
    </tr>
    <tr>
      <td>1776</td>
      <td>0.0</td>
      <td>2.193109e-07</td>
    </tr>
    <tr>
      <td>1777</td>
      <td>0.0</td>
      <td>2.565062e-07</td>
    </tr>
    <tr>
      <td>1778</td>
      <td>0.0</td>
      <td>2.196224e-07</td>
    </tr>
  </tbody>
</table>
<p>1779 rows &#215; 2 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[568]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#record index for each cluster to get labels</span>
<span class="n">centDictDocIndx</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">centDF</span><span class="p">)):</span>  <span class="c1">#use cluster total to iterate </span>
    <span class="n">centDictDocIndx</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">NYCclusters</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">NYCclusters</span><span class="p">[</span><span class="s2">&quot;Cluster&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">c</span><span class="p">]</span>  <span class="c1">#add to dict where ech key is a cluster and return the value as the indx of each doc</span>
<span class="nb">print</span><span class="p">(</span><span class="n">centDictDocIndx</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>{0: Int64Index([   0,    2,    3,    4,    5,    6,    8,   10,   15,   16,
            ...
            1769, 1770, 1771, 1772, 1773, 1774, 1775, 1776, 1777, 1778],
           dtype=&#39;int64&#39;, length=1251), 1: Int64Index([  12,   13,   18,   31,   34,   55,   61,   69,   75,   76,
            ...
            1663, 1674, 1699, 1715, 1716, 1719, 1722, 1726, 1753, 1762],
           dtype=&#39;int64&#39;, length=197), 2: Int64Index([   1,    7,    9,   11,   14,   20,   21,   29,   41,   43,
            ...
            1720, 1721, 1725, 1732, 1736, 1737, 1740, 1746, 1763, 1766],
           dtype=&#39;int64&#39;, length=331)}
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[569]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">streamPD</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="n">temp</span> <span class="o">=</span>  <span class="nb">dict</span><span class="p">()</span>
    <span class="n">test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">centDictDocIndx</span><span class="p">[</span><span class="n">j</span><span class="p">]:</span>
        <span class="n">streamPD</span> <span class="o">=</span>  <span class="n">streamPD</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">trainDF</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>  <span class="c1"># vs_trainDF.iloc[i]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">columnName</span><span class="p">,</span> <span class="n">columnData</span><span class="p">)</span> <span class="ow">in</span> <span class="n">streamPD</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
            <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="n">columnData</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">z</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">counter</span> <span class="o">=</span> <span class="n">counter</span> <span class="o">+</span> <span class="mi">1</span>
                    <span class="n">temp</span><span class="p">[</span><span class="n">columnName</span><span class="p">]</span> <span class="o">=</span> <span class="n">counter</span>
    <span class="n">test</span><span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span><span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">table</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">T</span>
    <span class="n">table</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;freq&#39;</span><span class="p">]</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cluster&quot;</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Total records in cluster&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">streamPD</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Top 10 attributes for each cluster&#39;</span><span class="p">)</span>
    <span class="n">table</span><span class="p">[</span><span class="s1">&#39;Record %&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="s1">&#39;freq&#39;</span><span class="p">]</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">streamPD</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">nlargest</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="s1">&#39;freq&#39;</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-----------------&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Cluster 0
Total records in cluster 1251

Top 10 attributes for each cluster
                                           freq  Record %
0                                        1248.0  0.997602
NY                                       1007.0  0.804956
Home Improvement Contractor - 100         280.0  0.223821
Misrepresentation - M01                   197.0  0.157474
Damaged Goods - D01                       132.0  0.105516
Furniture Sales - 242                     130.0  0.103917
Quality of Work - Q01                     119.0  0.095124
Exchange Goods/Contract Cancelled - E01   114.0  0.091127
Surcharge/Overcharge - S02                108.0  0.086331
Misc Non-Food Retail - 817                 99.0  0.079137

-----------------
Cluster 1
Total records in cluster 197

Top 10 attributes for each cluster
                                          freq  Record %
0                                        197.0  1.000000
Restitution                              197.0  1.000000
NY                                       158.0  0.802030
Tow Truck Company - 124                   51.0  0.258883
Misrepresentation - M01                   47.0  0.238579
Surcharge/Overcharge - S02                31.0  0.157360
Billing Dispute - B02                     22.0  0.111675
Exchange Goods/Contract Cancelled - E01   18.0  0.091371
Misc Non-Food Retail - 817                17.0  0.086294
Electronic Store - 001                    16.0  0.081218

-----------------
Cluster 2
Total records in cluster 331

Top 10 attributes for each cluster
                                    freq  Record %
Restitution                        328.0  0.990937
0                                  324.0  0.978852
NY                                 247.0  0.746224
Misrepresentation - M01             50.0  0.151057
Furniture Sales - 242               39.0  0.117825
Billing Dispute - B02               38.0  0.114804
Damaged Goods - D01                 38.0  0.114804
Secondhand Dealer Auto - 005        38.0  0.114804
Home Improvement Contractor - 100   37.0  0.111782
Debt Collection Agency - 122        31.0  0.093656

-----------------
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[570]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">completeness_score</span><span class="p">,</span><span class="n">homogeneity_score</span>


<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Completeness score&#39;</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="s1">&#39;  &#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">completeness_score</span><span class="p">(</span><span class="n">df_target_train</span><span class="p">,</span><span class="n">NYCclusters</span><span class="p">[</span><span class="s1">&#39;Cluster&#39;</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;homogeneity score&#39;</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="s1">&#39;   &#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">homogeneity_score</span><span class="p">(</span><span class="n">df_target_train</span><span class="p">,</span><span class="n">NYCclusters</span><span class="p">[</span><span class="s1">&#39;Cluster&#39;</span><span class="p">]))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Completeness score  0.22774314830865647
homogeneity score   0.27344034652815213
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[571]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">completeness</span> <span class="o">=</span> <span class="n">completeness_score</span><span class="p">(</span><span class="n">df_target_train</span><span class="p">,</span><span class="n">NYCclusters</span><span class="p">[</span><span class="s1">&#39;Cluster&#39;</span><span class="p">])</span>
<span class="n">homogeneity</span> <span class="o">=</span> <span class="n">homogeneity_score</span><span class="p">(</span><span class="n">df_target_train</span><span class="p">,</span><span class="n">NYCclusters</span><span class="p">[</span><span class="s1">&#39;Cluster&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[572]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;V-measure: &quot;</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">((</span><span class="n">homogeneity</span> <span class="o">*</span> <span class="n">completeness</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">homogeneity</span> <span class="o">+</span> <span class="n">completeness</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>V-measure:  0.2485084446494336
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Singular Value Decomposition-- See if we can reduce the dimensions of the data set<a rel="noopener" class="anchor-link" href="#Singular-Value-Decomposition---See-if-we-can-reduce-the-dimensions-of-the-data-set">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[573]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="n">df_train</span><span class="p">,</span> <span class="n">df_test</span><span class="p">,</span> <span class="n">df_target_train</span><span class="p">,</span> <span class="n">df_target_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">dfcopyWithDuration</span><span class="p">,</span> <span class="n">df_target</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">df_test</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">df_test</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>(445, 141)
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt output_prompt">Out[573]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Restitution</th>
      <th>Appliances - 244</th>
      <th>Auction House - 128</th>
      <th>Auto Dealership - 212</th>
      <th>Auto Leasing - 211</th>
      <th>Auto Rental - 213</th>
      <th>Booting Company - 126</th>
      <th>Car Wash</th>
      <th>Catering Establishment - 075</th>
      <th>Dealer In Products For The Disabled - 119</th>
      <th>...</th>
      <th>PA</th>
      <th>RI</th>
      <th>SC</th>
      <th>TN</th>
      <th>TX</th>
      <th>UT</th>
      <th>VA</th>
      <th>WA</th>
      <th>WI</th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2772</td>
      <td>773.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>15</td>
    </tr>
    <tr>
      <td>1232</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>29</td>
    </tr>
    <tr>
      <td>658</td>
      <td>90.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>22</td>
    </tr>
    <tr>
      <td>879</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>40</td>
    </tr>
    <tr>
      <td>540</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>64</td>
    </tr>
  </tbody>
</table>
<p>5 rows &#215; 141 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[574]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">TruncatedSVD</span>
<span class="kn">from</span> <span class="nn">scipy.sparse</span> <span class="kn">import</span> <span class="n">random</span> <span class="k">as</span> <span class="n">sparse_random</span>
<span class="kn">from</span> <span class="nn">sklearn.random_projection</span> <span class="kn">import</span> <span class="n">sparse_random_matrix</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[575]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">svd</span> <span class="o">=</span> <span class="n">TruncatedSVD</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_iter</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[576]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df_trainTRANS</span> <span class="o">=</span> <span class="n">svd</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[577]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df_testTRANS</span> <span class="o">=</span> <span class="n">svd</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df_test</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[578]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df_testTRANS</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>[[7.73010038e+02]
 [1.97681863e-02]
 [9.00149656e+01]
 [2.72424570e-02]
 [4.36072677e-02]
 [2.90006761e+02]
 [2.40002739e+03]
 [2.72513568e-02]
 [5.00008755e+02]
 [1.00001816e+03]
 [3.50012877e+02]
 [2.24779120e-02]
 [1.08986933e-02]
 [1.36394778e-02]
 [2.04330811e-02]
 [2.52021787e-02]
 [4.36021030e+02]
 [2.80011552e+02]
 [8.87085818e-03]
 [3.74777049e-02]
 [1.29587424e-02]
 [2.11306712e-02]
 [1.70440701e-02]
 [2.38536397e-02]
 [8.19578356e-03]
 [5.00027824e+02]
 [2.72604909e-02]
 [1.77246786e-02]
 [1.90876462e-02]
 [9.55400520e-03]
 [2.31569864e-02]
 [1.00019741e+02]
 [1.43209712e-02]
 [2.31729042e-02]
 [2.72600173e-02]
 [2.73582347e-03]
 [2.07565176e-03]
 [1.77277206e-02]
 [3.61152068e-02]
 [1.50015427e-02]
 [1.84085544e-02]
 [1.80001663e+03]
 [2.00001318e+03]
 [2.04508089e-02]
 [1.77240927e-02]
 [1.43197312e-02]
 [1.50024171e-02]
 [3.00001992e+02]
 [2.11146463e-02]
 [1.70013752e+01]
 [4.90016931e+02]
 [2.00013758e+01]
 [4.39679987e+04]
 [2.86235382e-02]
 [1.70277791e-02]
 [6.40122621e+01]
 [3.43293462e-03]
 [1.43148256e-02]
 [3.20352370e-02]
 [2.72534870e-02]
 [2.29045606e+02]
 [1.56834434e-02]
 [1.15944890e-02]
 [1.46900445e+03]
 [1.63738201e-02]
 [1.09364495e-02]
 [2.85018346e+02]
 [2.40004049e+02]
 [3.68097515e-02]
 [1.84064796e-02]
 [6.80258831e+01]
 [1.49850570e-02]
 [8.00170270e+01]
 [1.90879074e-02]
 [2.93035579e-02]
 [3.61226881e-02]
 [2.52172628e-02]
 [3.81005362e+02]
 [6.80054611e+01]
 [2.31792696e-02]
 [1.77250344e-02]
 [1.00109138e+01]
 [2.45377228e-02]
 [1.22620003e-02]
 [1.22765547e-02]
 [3.27193861e-02]
 [2.24924294e-02]
 [2.45200213e-02]
 [3.13564266e-02]
 [1.00014979e+02]
 [3.02385548e+00]
 [8.19210715e-03]
 [4.10574247e-03]
 [2.06141428e-03]
 [9.40136180e+01]
 [1.09140405e-02]
 [3.50008111e+02]
 [3.33826007e-02]
 [9.55421300e-03]
 [2.17802199e+03]
 [1.09201514e-02]
 [9.56131775e-03]
 [1.70639241e-02]
 [2.04508089e-02]
 [2.06957814e-03]
 [4.70100315e-02]
 [2.38551413e-02]
 [2.04511238e-02]
 [1.32000857e+03]
 [2.79517513e-02]
 [3.67962676e-02]
 [2.31561969e-02]
 [8.87027226e-03]
 [2.70000893e+03]
 [2.52162395e-02]
 [1.50063584e-02]
 [1.22660927e-02]
 [2.86310196e-02]
 [2.31746540e-02]
 [2.24779987e-02]
 [3.50095501e+01]
 [1.11021104e+02]
 [1.90973325e-02]
 [1.83904040e-02]
 [1.70470612e-02]
 [1.63684800e-02]
 [7.30028438e+02]
 [1.36015651e+02]
 [1.50026992e-02]
 [8.00408472e+00]
 [7.08691506e-04]
 [2.04488914e-02]
 [2.04483209e-02]
 [1.97677384e-02]
 [6.82728356e-03]
 [2.79488723e-02]
 [1.63687296e-02]
 [1.77247405e-02]
 [1.56839326e-02]
 [3.33884906e-02]
 [2.52173853e-02]
 [9.00886996e+00]
 [2.79429194e-02]
 [2.00024491e+02]
 [8.17003233e+02]
 [1.63620594e-02]
 [3.81558594e-02]
 [3.27162978e-02]
 [2.18032657e+02]
 [6.82729172e-03]
 [2.45375501e-02]
 [9.54634850e-03]
 [1.07203111e+03]
 [8.88025697e-03]
 [8.19093495e-03]
 [2.18203407e-02]
 [2.31738993e-02]
 [3.00010164e+02]
 [2.04511855e-02]
 [1.02390814e-02]
 [5.47611696e-03]
 [4.79389230e-03]
 [2.93043083e-02]
 [1.70639241e-02]
 [1.02330567e-02]
 [3.00007438e+02]
 [9.55200142e-03]
 [2.59127790e-02]
 [6.41012802e+02]
 [3.74020363e+02]
 [2.24932113e-02]
 [4.00014227e+02]
 [1.63684800e-02]
 [3.75033977e+02]
 [3.54341460e-02]
 [2.40143135e+01]
 [2.48007438e+02]
 [2.11298292e-02]
 [2.45211915e-02]
 [2.72678115e-02]
 [8.19810973e-03]
 [2.00004738e+02]
 [1.46015650e+02]
 [8.85443699e-03]
 [2.00009507e+02]
 [3.00023796e+02]
 [5.46753173e-03]
 [5.00001725e+03]
 [4.49006037e+02]
 [2.62014939e+02]
 [4.78647095e-03]
 [2.80136338e+01]
 [2.79403594e-02]
 [1.96024474e+02]
 [1.30502900e+03]
 [3.81588311e-02]
 [2.52182343e-02]
 [1.43299071e-02]
 [3.10286262e+01]
 [6.82965328e-03]
 [2.25003861e-02]
 [2.04493543e-02]
 [2.18125325e-02]
 [2.24930041e-02]
 [2.65779447e-02]
 [3.42434939e-03]
 [2.18133070e-02]
 [1.43213350e-02]
 [2.31628126e-02]
 [2.52160518e-02]
 [4.10968879e-03]
 [9.55155698e-03]
 [1.90115915e+01]
 [2.24940512e-02]
 [2.79430267e-02]
 [4.50109150e+01]
 [2.86235382e-02]
 [1.29573053e-02]
 [2.86237070e-02]
 [6.82919534e-03]
 [9.80000471e+02]
 [1.43204129e-02]
 [6.82968129e-03]
 [2.24943678e-02]
 [3.64201756e+03]
 [3.40570667e-03]
 [5.00136263e+01]
 [1.89601184e+03]
 [2.11310897e-02]
 [9.55263799e-03]
 [1.75000981e+03]
 [1.35001196e+03]
 [1.90865683e-02]
 [5.00011479e+02]
 [6.00136247e+01]
 [7.50835250e-03]
 [1.50027397e+01]
 [3.42190459e-03]
 [6.30197547e+01]
 [1.90726081e-02]
 [2.45387297e-02]
 [1.62300920e+03]
 [1.70496984e-02]
 [2.86073921e-02]
 [1.18302153e+03]
 [1.36244521e-02]
 [2.38625076e-02]
 [1.29677855e-02]
 [4.79059516e-03]
 [2.31725481e-02]
 [9.55291060e-03]
 [2.51012900e+02]
 [6.47002644e+03]
 [2.38565547e-02]
 [2.51008138e+02]
 [1.43208628e-02]
 [2.79428540e-02]
 [1.63018368e+02]
 [2.38545509e-02]
 [3.67966442e-02]
 [1.00023833e+02]
 [3.57801758e+03]
 [3.47665692e-02]
 [2.86232475e-02]
 [3.00001362e+03]
 [2.86370221e-02]
 [2.59061905e-02]
 [2.00030604e+02]
 [6.82760718e-03]
 [9.55343846e-03]
 [2.11334258e-02]
 [3.88378288e-02]
 [6.13001040e-03]
 [6.14619644e-03]
 [2.00007462e+02]
 [1.25032690e+02]
 [4.50047744e+01]
 [1.02485507e-02]
 [2.68800757e+03]
 [1.50075162e+01]
 [1.02169100e-02]
 [1.02181836e-02]
 [3.27100814e-02]
 [2.80017644e+02]
 [1.70526387e-02]
 [6.09014179e+02]
 [3.81658705e-02]
 [7.19280051e+04]
 [1.56907422e-02]
 [2.52186109e-02]
 [2.50177142e+01]
 [1.36500630e-02]
 [6.99852657e-04]
 [1.50000854e+03]
 [1.36606927e-02]
 [5.00047749e+01]
 [1.02005464e+02]
 [3.13478261e-02]
 [1.36406430e-02]
 [2.31748584e-02]
 [8.18918514e-03]
 [2.11263250e-02]
 [2.31955436e-02]
 [8.30292688e+01]
 [1.29577410e-02]
 [2.31822503e-02]
 [4.10551897e-03]
 [3.00022425e+02]
 [4.78495640e-03]
 [1.70455050e-02]
 [2.79428697e-02]
 [1.77195932e-02]
 [9.55309101e-03]
 [1.97701900e-02]
 [6.66028469e+02]
 [1.10143189e+01]
 [3.44018328e+02]
 [6.83003524e-03]
 [3.27096122e-02]
 [2.45358608e-02]
 [1.43187557e-02]
 [2.11334258e-02]
 [2.79253211e-02]
 [1.57016311e+02]
 [5.46540542e-03]
 [7.10143052e+01]
 [1.56825344e-02]
 [1.77254130e-02]
 [3.88394946e-02]
 [2.93120803e-02]
 [1.50097272e-02]
 [1.00000525e+03]
 [1.90861994e-02]
 [3.53001078e+03]
 [2.65845401e-02]
 [1.40095335e+01]
 [4.29258146e-02]
 [1.56660076e-02]
 [1.72650035e+04]
 [2.45371736e-02]
 [6.15565495e-03]
 [2.86221033e-02]
 [7.50004621e+02]
 [1.27500653e+03]
 [1.36019058e+02]
 [2.86239148e-02]
 [1.49838252e-02]
 [8.88025697e-03]
 [8.19131690e-03]
 [4.90047752e+01]
 [1.00018384e+02]
 [1.22617095e-02]
 [2.65779711e-02]
 [4.90027129e+02]
 [1.95021762e+02]
 [1.84067775e-02]
 [6.00109010e+01]
 [3.61052763e-02]
 [1.09234393e-02]
 [1.50022963e-02]
 [6.90333793e+01]
 [7.50008036e+02]
 [2.11318697e-02]
 [1.77252530e-02]
 [8.19056214e-03]
 [2.59086710e-02]
 [2.19017675e+02]
 [1.22801948e+03]
 [8.19810973e-03]
 [1.02347036e-02]
 [5.64012811e+02]
 [3.43164821e-03]
 [1.70455050e-02]
 [2.74339741e-03]
 [2.38551870e-02]
 [2.65807325e-02]
 [3.40724010e-02]
 [6.14775261e-03]
 [3.00014237e+02]
 [4.22582377e-02]
 [1.43198270e-02]
 [4.10301410e-03]
 [3.40724167e-02]
 [2.06233663e-03]
 [2.38565547e-02]
 [1.97698647e-02]
 [2.04493327e-02]
 [9.55354574e-03]
 [1.56824634e-02]
 [1.36394544e-02]
 [2.59082891e-02]
 [3.27102952e-02]
 [1.80068087e+01]
 [3.74593470e-02]
 [1.36345934e-02]
 [7.50823316e-03]
 [1.50027149e-02]
 [1.56826602e-02]
 [1.39016333e+02]
 [4.22427664e-02]
 [2.72435063e-02]
 [4.76918185e-03]
 [3.06670971e-02]
 [3.13481211e-02]
 [3.20263542e-02]
 [2.79430267e-02]
 [2.58822986e-02]
 [2.50033996e+02]
 [2.07081306e-03]
 [1.49842905e-02]
 [2.58997370e-02]
 [2.31748584e-02]
 [6.83457445e-04]
 [1.70700781e+03]
 [4.34016246e+02]
 [5.00029196e+02]
 [6.80115808e+01]
 [2.24916064e-02]
 [2.75019025e+02]
 [1.70518999e-02]
 [6.80061421e+01]
 [3.20289021e-02]
 [1.36394475e-02]
 [1.90896152e-02]
 [5.00029870e+02]
 [3.33884906e-02]
 [5.28016226e+02]
 [2.18120046e-02]
 [2.52016299e+02]
 [3.33900379e-02]
 [2.93132442e-02]
 [3.81531072e-02]
 [1.49202622e+03]
 [1.25013609e+02]
 [5.00027145e+02]
 [9.55240150e-03]
 [6.82739940e-03]
 [2.38564894e-02]
 [3.13481736e-02]
 [1.50026992e-02]
 [3.27102795e-02]
 [2.31754286e-02]
 [2.86214280e-02]
 [3.33886608e-02]
 [2.38564894e-02]]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[579]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">svd</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>[0.99998741]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[580]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">svd</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>0.9999874056618058
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[583]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#use the same parameters from the grid search result and now the SVD transformation</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">tree</span>

<span class="n">treeclfOpt</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">criterion</span><span class="o">=</span> <span class="s1">&#39;entropy&#39;</span><span class="p">,</span> <span class="n">max_leaf_nodes</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span> <span class="n">max_depth</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span> <span class="n">min_samples_leaf</span><span class="o">=</span> <span class="mi">24</span><span class="p">,</span> <span class="n">min_samples_split</span><span class="o">=</span> <span class="mi">10</span><span class="p">)</span> <span class="c1">#max_leaf_nodes</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[584]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">treeclfOpt</span> <span class="o">=</span> <span class="n">treeclfOpt</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df_trainTRANS</span><span class="p">,</span> <span class="n">df_target_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[585]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">treepreds_test</span> <span class="o">=</span> <span class="n">treeclfOpt</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">df_testTRANS</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">treepreds_test</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>[&#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;No&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39; &#39;Yes&#39;
 &#39;Yes&#39;]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[&#160;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">testTarg</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">df_target_test</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[&#160;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">treeclfOpt</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">df_testTRANS</span><span class="p">,</span> <span class="n">testTarg</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&#160;[&#160;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
    </div>
  </div>


 



<script type="text/javascript" src="/d2l/common/math/MathML.js?v=20.21.1.27113-324 "></script><script type="text/javascript">document.addEventListener('DOMContentLoaded', function() { D2LMathML.DesktopInit('https://s.brightspace.com/lib/mathjax/2.7.4/MathJax.js?config=MML_HTMLorMML','https://s.brightspace.com/lib/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML','130'); });</script></body></html>